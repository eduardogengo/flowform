<p>form: {{ formState.formData() | json }}</p>

<div class="card flex justify-center">
  <form [formGroup]="form" (ngSubmit)="submit()">
    <p-stepper [value]="1" class="basis-[50rem]">
      <p-step-list>
        <p-step [value]="1">Personal Details</p-step>
        <p-step [value]="2" [disabled]="!isStepValid(1)" (click)="changeStep(2)">Contact Information</p-step>
        <p-step [value]="3" [disabled]="!isStepValid(1) || !isStepValid(2)" (click)="changeStep(3)">Confirmation</p-step>
      </p-step-list>
      <p-step-panels>
        <p-step-panel [value]="1">
          <ng-template #content let-activateCallback="activateCallback">
            <div class="flex flex-col h-48">
              <div
                class="border-2 border-dashed border-surface-200 dark:border-surface-700 rounded bg-surface-50 dark:bg-surface-950 flex-auto flex justify-center items-center font-medium"
              >
                <div class="">
                  <div class="field firstName-field mb-5">
                    <p-iftalabel>
                      <input
                        pInputText
                        id="firstName"
                        formControlName="firstName"
                        autocomplete="off"
                      />
                      <label for="firstName">First Name</label>
                    </p-iftalabel>
                    <app-field-error-validation
                      [control]="form.get('firstName')"
                    ></app-field-error-validation>
                  </div>
                  <div class="field lastName-field">
                    <p-iftalabel>
                      <input
                        pInputText
                        id="lastName"
                        formControlName="lastName"
                        autocomplete="off"
                      />
                      <label for="lastName">Last Name</label>
                    </p-iftalabel>
                    <app-field-error-validation
                      [control]="form.get('lastName')"
                    ></app-field-error-validation>
                  </div>
                </div>
              </div>
            </div>
            <div class="flex pt-6 justify-end">
              <p-button
                label="Next"
                icon="pi pi-arrow-right"
                iconPos="right"
                (onClick)="onNext(activateCallback, 1, 2)"
              />
            </div>
          </ng-template>
        </p-step-panel>

        <p-step-panel [value]="2">
          <ng-template #content let-activateCallback="activateCallback">
            <div class="flex flex-col h-60">
              <div
                class="border-2 border-dashed border-surface-200 dark:border-surface-700 rounded bg-surface-50 dark:bg-surface-950 flex-auto flex justify-center items-center font-medium"
              >
                <div class="">
                  <div class="field email-field mb-5">
                    <p-iftalabel>
                      <input
                        pInputText
                        id="email"
                        formControlName="email"
                        inputmode="email"
                        autocomplete="off"
                      />
                      <label for="email">Email</label>
                    </p-iftalabel>
                    <app-field-error-validation
                      [control]="form.get('email')"
                    ></app-field-error-validation>
                  </div>
                  <div class="field email-confirmation-field mb-5">
                    <p-iftalabel>
                      <input
                        pInputText
                        id="emailConfirmation"
                        formControlName="emailConfirmation"
                        inputmode="email"
                        autocomplete="off"
                      />
                      <label for="emailConfirmation">Email Confirmation</label>
                    </p-iftalabel>
                    <app-field-error-validation
                      [control]="form.get('emailConfirmation')"
                    ></app-field-error-validation>
                  </div>
                  <div class="field phone-field">
                    <p-iftalabel>
                      <p-inputmask
                        id="phone"
                        formControlName="phone"
                        mask="(99) 99999-9999"
                        type="tel"
                        autocomplete="off"
                      />
                      <label for="phone">Phone</label>
                    </p-iftalabel>
                    <app-field-error-validation
                      [control]="form.get('phone')"
                    ></app-field-error-validation>
                  </div>
                </div>
              </div>
            </div>
            <div class="flex pt-6 justify-between">
              <p-button
                label="Back"
                severity="secondary"
                icon="pi pi-arrow-left"
                (onClick)="onBack(activateCallback, 1)"
              />
              <p-button
                label="Next"
                icon="pi pi-arrow-right"
                iconPos="right"
                (onClick)="onNext(activateCallback, 2, 3)"
              />
            </div>
          </ng-template>
        </p-step-panel>

        <p-step-panel [value]="3">
          <ng-template #content let-activateCallback="activateCallback">
            <p-card>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <strong>First Name</strong>
                  <p>{{ form.get('firstName')?.value }}</p>
                </div>
                <div>
                  <strong>Last Name</strong>
                  <p>{{ form.get('lastName')?.value }}</p>
                </div>
                <div>
                  <strong>Email</strong>
                  <p>{{ form.get('email')?.value }}</p>
                </div>
                <div>
                  <strong>Phone</strong>
                  <p>{{ form.get('phone')?.value }}</p>
                </div>
              </div>
            </p-card>
            <div class="flex pt-6 justify-between">
              <p-button
                label="Back"
                icon="pi pi-arrow-left"
                (onClick)="onBack(activateCallback, 2)"
              />
              <p-button type="submit" label="Confirm" [disabled]="form.invalid"></p-button>
            </div>
          </ng-template>
        </p-step-panel>
      </p-step-panels>
    </p-stepper>
  </form>
</div>
